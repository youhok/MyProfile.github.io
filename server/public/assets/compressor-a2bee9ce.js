import{H as ye}from"./index-9b4b9f04.js";const we={toBase64:a=>new Promise((e,r)=>{const t=new FileReader;t.readAsDataURL(a),t.onload=()=>{var i;return e(((i=t.result)==null?void 0:i.toString())||"")},t.onerror=i=>r(i)}),toBlob:a=>new Blob([a],{type:"plain/text"}),fromUrl:(a,e)=>new Promise(r=>{fetch(a).then(t=>{t.blob().then(i=>{const n=new File([i],e,{type:i.type});r(n)})})})},Xe=we;/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function oe(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);e&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,t)}return r}function D(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oe(Object(r),!0).forEach(function(t){Ue(a,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach(function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(r,t))})}return a}function xe(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function se(a,e){for(var r=0;r<e.length;r++){var t=e[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,he(t.key),t)}}function Be(a,e,r){return e&&se(a.prototype,e),r&&se(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ue(a,e,r){return e=he(e),e in a?Object.defineProperty(a,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[e]=r,a}function C(){return C=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(a[t]=r[t])}return a},C.apply(this,arguments)}function Re(a,e){if(typeof a!="object"||a===null)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var t=r.call(a,e||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function he(a){var e=Re(a,"string");return typeof e=="symbol"?e:String(e)}var ve={exports:{}};(function(a){typeof window>"u"||function(e){var r=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,t=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),i=t&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,u=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,f=(t||n)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(s){var l,c,h,b,v,o,p,m,x;if(l=s.match(u),!l)throw new Error("invalid data URI");for(c=l[2]?l[1]:"text/plain"+(l[3]||";charset=US-ASCII"),h=!!l[4],b=s.slice(l[0].length),h?v=atob(b):v=decodeURIComponent(b),o=new ArrayBuffer(v.length),p=new Uint8Array(o),m=0;m<v.length;m+=1)p[m]=v.charCodeAt(m);return t?new Blob([i?p:o],{type:c}):(x=new n,x.append(o),x.getBlob(c))};e.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(s,l,c){var h=this;setTimeout(function(){c&&r.toDataURL&&f?s(f(h.toDataURL(l,c))):s(h.mozGetAsFile("blob",l))})}:r.toDataURL&&f&&(r.msToBlob?r.toBlob=function(s,l,c){var h=this;setTimeout(function(){(l&&l!=="image/png"||c)&&r.toDataURL&&f?s(f(h.toDataURL(l,c))):s(h.msToBlob(l))})}:r.toBlob=function(s,l,c){var h=this;setTimeout(function(){s(f(h.toDataURL(l,c)))})})),a.exports?a.exports=f:e.dataURLtoBlob=f}(window)})(ve);var le=ve.exports,Ee=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},fe={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Ae=typeof window<"u"&&typeof window.document<"u",y=Ae?window:{},j=function(e){return e>0&&e<1/0},Te=Array.prototype.slice;function z(a){return Array.from?Array.from(a):Te.call(a)}var Oe=/^image\/.+$/;function W(a){return Oe.test(a)}function Fe(a){var e=W(a)?a.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var me=String.fromCharCode;function Pe(a,e,r){var t="",i;for(r+=e,i=e;i<r;i+=1)t+=me(a.getUint8(i));return t}var De=y.btoa;function ue(a,e){for(var r=[],t=8192,i=new Uint8Array(a);i.length>0;)r.push(me.apply(null,z(i.subarray(0,t)))),i=i.subarray(t);return"data:".concat(e,";base64,").concat(De(r.join("")))}function Ce(a){var e=new DataView(a),r;try{var t,i,n;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var u=e.byteLength,f=2;f+1<u;){if(e.getUint8(f)===255&&e.getUint8(f+1)===225){i=f;break}f+=1}if(i){var s=i+4,l=i+10;if(Pe(e,s,4)==="Exif"){var c=e.getUint16(l);if(t=c===18761,(t||c===19789)&&e.getUint16(l+2,t)===42){var h=e.getUint32(l+4,t);h>=8&&(n=l+h)}}}if(n){var b=e.getUint16(n,t),v,o;for(o=0;o<b;o+=1)if(v=n+o*12+2,e.getUint16(v,t)===274){v+=8,r=e.getUint16(v,t),e.setUint16(v,1,t);break}}}catch{r=1}return r}function je(a){var e=0,r=1,t=1;switch(a){case 2:r=-1;break;case 3:e=-180;break;case 4:t=-1;break;case 5:e=90,t=-1;break;case 6:e=90;break;case 7:e=90,r=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:r,scaleY:t}}var Le=/\.\d*(?:0|9){12}\d*$/;function ce(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Le.test(a)?Math.round(a*e)/e:a}function P(a){var e=a.aspectRatio,r=a.height,t=a.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",n=j(t),u=j(r);if(n&&u){var f=r*e;(i==="contain"||i==="none")&&f>t||i==="cover"&&f<t?r=t/e:t=r*e}else n?r=t/e:u&&(t=r*e);return{width:t,height:r}}function ke(a){for(var e=z(new Uint8Array(a)),r=e.length,t=[],i=0;i+3<r;){var n=e[i],u=e[i+1];if(n===255&&u===218)break;if(n===255&&u===216)i+=2;else{var f=e[i+2]*256+e[i+3],s=i+f+2,l=e.slice(i,s);t.push(l),i=s}}return t.reduce(function(c,h){return h[0]===255&&h[1]===225?c.concat(h):c},[])}function Me(a,e){var r=z(new Uint8Array(a));if(r[2]!==255||r[3]!==224)return a;var t=r[4]*256+r[5],i=[255,216].concat(e,r.slice(4+t));return new Uint8Array(i)}var Ie=y.ArrayBuffer,S=y.FileReader,w=y.URL||y.webkitURL,He=/\.\w+$/,Se=y.Compressor,We=function(){function a(e,r){xe(this,a),this.file=e,this.exif=[],this.image=new Image,this.options=D(D({},fe),r),this.aborted=!1,this.result=null,this.init()}return Be(a,[{key:"init",value:function(){var r=this,t=this.file,i=this.options;if(!Ee(t)){this.fail(new Error("The first argument must be a File or Blob object."));return}var n=t.type;if(!W(n)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!w||!S){this.fail(new Error("The current browser does not support image compression."));return}Ie||(i.checkOrientation=!1,i.retainExif=!1);var u=n==="image/jpeg",f=u&&i.checkOrientation,s=u&&i.retainExif;if(w&&!f&&!s)this.load({url:w.createObjectURL(t)});else{var l=new S;this.reader=l,l.onload=function(c){var h=c.target,b=h.result,v={},o=1;f&&(o=Ce(b),o>1&&C(v,je(o))),s&&(r.exif=ke(b)),f||s?!w||o>1?v.url=ue(b,n):v.url=w.createObjectURL(t):v.url=b,r.load(v)},l.onabort=function(){r.fail(new Error("Aborted to read the image with FileReader."))},l.onerror=function(){r.fail(new Error("Failed to read the image with FileReader."))},l.onloadend=function(){r.reader=null},f||s?l.readAsArrayBuffer(t):l.readAsDataURL(t)}}},{key:"load",value:function(r){var t=this,i=this.file,n=this.image;n.onload=function(){t.draw(D(D({},r),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){t.fail(new Error("Aborted to load the image."))},n.onerror=function(){t.fail(new Error("Failed to load the image."))},y.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(y.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=r.url}},{key:"draw",value:function(r){var t=this,i=r.naturalWidth,n=r.naturalHeight,u=r.rotate,f=u===void 0?0:u,s=r.scaleX,l=s===void 0?1:s,c=r.scaleY,h=c===void 0?1:c,b=this.file,v=this.image,o=this.options,p=document.createElement("canvas"),m=p.getContext("2d"),x=Math.abs(f)%180===90,L=(o.resize==="contain"||o.resize==="cover")&&j(o.width)&&j(o.height),R=Math.max(o.maxWidth,0)||1/0,E=Math.max(o.maxHeight,0)||1/0,A=Math.max(o.minWidth,0)||0,T=Math.max(o.minHeight,0)||0,B=i/n,g=o.width,d=o.height;if(x){var G=[E,R];R=G[0],E=G[1];var X=[T,A];A=X[0],T=X[1];var $=[d,g];g=$[0],d=$[1]}L&&(B=g/d);var N=P({aspectRatio:B,width:R,height:E},"contain");R=N.width,E=N.height;var Y=P({aspectRatio:B,width:A,height:T},"cover");if(A=Y.width,T=Y.height,L){var V=P({aspectRatio:B,width:g,height:d},o.resize);g=V.width,d=V.height}else{var K=P({aspectRatio:B,width:g,height:d}),q=K.width;g=q===void 0?i:q;var J=K.height;d=J===void 0?n:J}g=Math.floor(ce(Math.min(Math.max(g,A),R))),d=Math.floor(ce(Math.min(Math.max(d,T),E)));var ge=-g/2,de=-d/2,be=g,pe=d,k=[];if(L){var Q=0,Z=0,M=i,I=n,_=P({aspectRatio:B,width:i,height:n},{contain:"cover",cover:"contain"}[o.resize]);M=_.width,I=_.height,Q=(i-M)/2,Z=(n-I)/2,k.push(Q,Z,M,I)}if(k.push(ge,de,be,pe),x){var ee=[d,g];g=ee[0],d=ee[1]}p.width=g,p.height=d,W(o.mimeType)||(o.mimeType=b.type);var te="transparent";b.size>o.convertSize&&o.convertTypes.indexOf(o.mimeType)>=0&&(o.mimeType="image/jpeg");var re=o.mimeType==="image/jpeg";if(re&&(te="#fff"),m.fillStyle=te,m.fillRect(0,0,g,d),o.beforeDraw&&o.beforeDraw.call(this,m,p),!this.aborted&&(m.save(),m.translate(g/2,d/2),m.rotate(f*Math.PI/180),m.scale(l,h),m.drawImage.apply(m,[v].concat(k)),m.restore(),o.drew&&o.drew.call(this,m,p),!this.aborted)){var ae=function(O){if(!t.aborted){var ie=function(F){return t.done({naturalWidth:i,naturalHeight:n,result:F})};if(O&&re&&o.retainExif&&t.exif&&t.exif.length>0){var ne=function(F){return ie(le(ue(Me(F,t.exif),o.mimeType)))};if(O.arrayBuffer)O.arrayBuffer().then(ne).catch(function(){t.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var U=new S;t.reader=U,U.onload=function(H){var F=H.target;ne(F.result)},U.onabort=function(){t.fail(new Error("Aborted to read the compressed image with FileReader."))},U.onerror=function(){t.fail(new Error("Failed to read the compressed image with FileReader."))},U.onloadend=function(){t.reader=null},U.readAsArrayBuffer(O)}}else ie(O)}};p.toBlob?p.toBlob(ae,o.mimeType,o.quality):ae(le(p.toDataURL(o.mimeType,o.quality)))}}},{key:"done",value:function(r){var t=r.naturalWidth,i=r.naturalHeight,n=r.result,u=this.file,f=this.image,s=this.options;if(w&&f.src.indexOf("blob:")===0&&w.revokeObjectURL(f.src),n)if(s.strict&&!s.retainExif&&n.size>u.size&&s.mimeType===u.type&&!(s.width>t||s.height>i||s.minWidth>t||s.minHeight>i||s.maxWidth<t||s.maxHeight<i))n=u;else{var l=new Date;n.lastModified=l.getTime(),n.lastModifiedDate=l,n.name=u.name,n.name&&n.type!==u.type&&(n.name=n.name.replace(He,Fe(n.type)))}else n=u;this.result=n,s.success&&s.success.call(this,n)}},{key:"fail",value:function(r){var t=this.options;if(t.error)t.error.call(this,r);else throw r}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Se,a}},{key:"setDefaults",value:function(r){C(fe,r)}}]),a}();const $e=async(a,e=.8,r=1)=>{const t=parseInt(`${r}000000`);try{return new Promise((i,n)=>{new We(a,{quality:e,convertSize:t,success(u){i(u)},error(u){n(u)}})})}catch(i){return ye.error(i.message)}};export{Xe as C,$e as c};
